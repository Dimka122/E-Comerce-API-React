{'role': 'assistant', 'content': '\nNow let me create the AuthContext for managing authentication state:\n\n<function_calls>\n<create-file file_path="online-store-frontend/src/contexts/AuthContext.tsx">\nimport React, { createContext, useContext, useReducer, useEffect, ReactNode } from \'react\';\nimport { User, LoginRequest, RegisterRequest, AuthResponse } from \'../types\';\nimport { authApi } from \'../services/api\';\n\ninterface AuthState {\n  user: User | null;\n  token: string | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n}\n\ntype AuthAction =\n  | { type: \'LOGIN_START\' }\n  | { type: \'LOGIN_SUCCESS\'; payload: { user: User; token: string } }\n  | { type: \'LOGIN_FAILURE\' }\n  | { type: \'LOGOUT\' }\n  | { type: \'SET_LOADING\'; payload: boolean };\n\nconst initialState: AuthState = {\n  user: null,\n  token: localStorage.getItem(\'token\'),\n  isLoading: false,\n  isAuthenticated: false,\n};\n\nconst authReducer = (state: AuthState, action: AuthAction): AuthState => {\n  switch (action.type) {\n    case \'LOGIN_START\':\n      return { ...state, isLoading: true };\n    case \'LOGIN_SUCCESS\':\n      return {\n        ...state,\n        user: action.payload.user,\n        token: action.payload.token,\n        isLoading: false,\n        isAuthenticated: true,\n      };\n    case \'LOGIN_FAILURE\':\n      return {\n        ...state,\n        user: null,\n        token: null,\n        isLoading: false,\n        isAuthenticated: false,\n      };\n    case \'LOGOUT\':\n      return {\n        ...state,\n        user: null,\n        token: null,\n        isLoading: false,\n        isAuthenticated: false,\n      };\n    case \'SET_LOADING\':\n      return { ...state, isLoading: action.payload };\n    default:\n      return state;\n  }\n};\n\ninterface AuthContextType {\n  user: User | null;\n  token: string | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  login: (credentials: LoginRequest) => Promise<void>;\n  register: (userData: RegisterRequest) => Promise<void>;\n  logout: () => void;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\'useAuth must be used within an AuthProvider\');\n  }\n  return context;\n};\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [state, dispatch] = useReducer(authReducer, initialState);\n\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem(\'token\');\n      if (token) {\n        try {\n          dispatch({ type: \'SET_LOADING\', payload: true });\n          const user = await authApi.getCurrentUser();\n          dispatch({ type: \'LOGIN_SUCCESS\', payload: { user, token } });\n        } catch (error) {\n          localStorage.removeItem(\'token\');\n          dispatch({ type: \'LOGIN_FAILURE\' });\n        }\n      }\n      dispatch({ type: \'SET_LOADING\', payload: false });\n    };\n\n    initAuth();\n  }, []);\n\n  const login = async (credentials: LoginRequest): Promise<void> => {\n    try {\n      dispatch({ type: \'LOGIN_START\' });\n      const response: AuthResponse = await authApi.login(credentials);\n      localStorage.setItem(\'token\', response.token);\n      dispatch({ type: \'LOGIN_SUCCESS\', payload: { user: response.user, token: response.token } });\n    } catch (error) {\n      dispatch({ type: \'LOGIN_FAILURE\' });\n      throw error;\n    }\n  };\n\n  const register = async (userData: RegisterRequest): Promise<void> => {\n    try {\n      dispatch({ type: \'LOGIN_START\' });\n      const response: AuthResponse = await authApi.register(userData);\n      localStorage.setItem(\'token\', response.token);\n      dispatch({ type: \'LOGIN_SUCCESS\', payload: { user: response.user, token: response.token } });\n    } catch (error) {\n      dispatch({ type: \'LOGIN_FAILURE\' });\n      throw error;\n    }\n  };\n\n  const logout = (): void => {\n    localStorage.removeItem(\'token\');\n    dispatch({ type: \'LOGOUT\' });\n  };\n\n  const value: AuthContextType = {\n    ...state,\n    login,\n    register,\n    logout,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n</create-file>\n</function_calls>'}